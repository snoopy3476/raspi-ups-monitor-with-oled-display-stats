#!/usr/bin/env python3

# [oled-stats]
#
# A script for displaying Raspi info (with 52pi UPS Plus) in Adafruit_SSD1306 128x64 oled screen.
# It periodically prints following info:
#   - IPs of interfaces (eth0, wlan0) and their usage (0-100, only if possible)
#   - CPU usages in percentage bar (for each core) and temperature ('C)
#   - Memory usage
#   - Sdcard storage usage (for partition "/") and its i/o usage (busy time ratio)
#   - Pi power consumption (W)
#   - UPS battery power charge/discharge rate (W)
#   - UPS battery voltage, battery level (0-100), temperature ('C)
#
# Author: Kim Hwiwon <kim.hwiwon@outlook.com>
# License: The MIT License
#
# usage: oled-stats [-c]
#                   -c: Clear mode
#                       Only clear oled display if anything is remaining after unusual exit


from time import time, sleep
from datetime import datetime
from base64 import b64decode
from io import BytesIO
from PIL import Image, ImageDraw, ImageFont
from Adafruit_SSD1306 import SSD1306_128_64
from smbus2 import SMBus
from ina219 import INA219
import psutil
from socket import AF_INET
from sys import argv, exit
from signal import signal, SIGINT, SIGQUIT, SIGTERM, SIGHUP





### config ###


# device config
DEVICE_BUS = 1
DEVICE_ADDR = 0x17


# device init
INA_INIT = False
try:
	bus = SMBus(DEVICE_BUS)
	ina_pi = INA219(0.00725, address=0x40)
	ina_pi.configure()
	ina_batt = INA219(0.005, address=0x45)
	ina_batt.configure()
	INA_INIT = True
except:
	pass


# embeded font - Mozart NBP
FONT_BASE64 = "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gP8AAAADAQAAAAIAA4AAAwAHAAsAACE1MxUlETMRETUzFQGAgP8AgICAgIACgP2AAoCAgAADAIAAAAGAA4AAAwAHAAsAADM1MxU1ETMRATUzFYCAgP8AgICAgAKA/YACgICAAAAGAAAAgAKAA4AAAwAHAAsADwATABcAADcRMxEzETMRATUzFSU1IRUzNSEVJREzEYCAgID/AID+gAEAgAEA/oCAgAEA/wABAP8AAQCAgICAgICAgAEA/wAAAQAAAIACgAMAAAsAACURITUhETMRIRUhEQEA/wABAIABAP8AgAEAgAEA/wCA/wAAAgAAAAABAAGAAAMACQAAMTUzFTU1IzUhEYCAAQCAgICAgP8AAAAAAAEAAAGAAoACAAADAAARNSEVAoABgICAAAEAAAAAAQABAAADAAAxESERAQABAP8AAAUAAACAAoADAAADAAcACwAPABMAADU1MxU1NTMVNTUzFTU1MxU1NTMVgICAgICAgICAgICAgICAgICAgIAAAAAFAAAAAAKAA4AAAwAHAA8AFwAbAAAzNSEVATUzFQERMxUzFSMRITUjNTMRMxEBNSEVgAGA/wCA/oCAgIABgICAgP4AAYCAgAGAgID/AAKAgID+gICAAYD9gAKAgIAAAAABAIAAAAIAA4AACwAAMzUzESM1MzUzETMVgICAgICAgAIAgID9AIAABwAAAAACgAOAAAUACQANABEAFQAZAB0AADERMxUhFQE1MxU1NTMVNTUzFSU1MxUhNTMVJTUhFYACAP4AgICA/gCAAYCA/gABgAEAgIABAICAgICAgICAgICAgICAgIAABQAAAAACgAOAAAMABwALAA8AEwAAMTUhFTURMxEBNSEVNREzEQE1IRUCAID+AAGAgP2AAgCAgIABAP8AAQCAgIABAP8AAQCAgAAAAAEAAAAAAoADgAATAAAhESE1MzUzFTM1IzUzNTMRMxUjEQGA/oCAgICAgICAgAGAgICAgICA/oCA/oAAAAMAAAAAAoADgAADAAcADwAAMTUhFTURMxEBESEVIREhFQIAgP2AAoD+AAGAgICAAQD/AAEAAgCA/wCAAAQAAAAAAoADgAADAAcADwATAAAzNSEVNREzESERMxEhFSERETUhFYABgID9gIABgP6AAYCAgIABAP8AAoD/AID/AAKAgIAAAAMAAAAAAoADgAADAAcADwAAIREzERERMxERESEVIxEhEQEAgID+gIACgAEA/wABAAEA/wABAAEAgAEA/oAAAAAHAAAAAAKAA4AAAwAHAAsADwATABcAGwAAMzUhFSURMxEhETMRATUhFSURMxEhETMRATUhFYABgP4AgAGAgP4AAYD+AIABgID+AAGAgICAAQD/AAEA/wABAICAgAEA/wABAP8AAQCAgAAAAAAEAAAAAAKAA4AAAwAHAA8AEwAAMzUhFQERMxEBESE1IREzEQE1IRWAAYD+AIABgP6AAYCA/gABgICAAgABAP8A/oABAIABAP2AAoCAgAAAAAIAAAAAAQADAAADAAcAADERIREBESERAQD/AAEAAQD/AAIAAQD/AAADAAAAAAEAAwAAAwAJAA0AADE1MxU1NSM1IREBESERgIABAP8AAQCAgICAgP8AAYABAP8AAAAAAAUAgACAAgADAAADAAcACwAPABMAACU1MxUlNTMVJTUzFTU1MxU1NTMVAYCA/wCA/wCAgICAgICAgICAgICAgICAgIAAAgCAAQACAAKAAAMABwAAEzUhFQE1IRWAAYD+gAGAAQCAgAEAgIAAAAUAgACAAgADAAADAAcACwAPABMAADc1MxU1NTMVNTUzFSU1MxUlNTMVgICAgP8AgP8AgICAgICAgICAgICAgICAgAAABgAAAAACgAOAAAMABwALAA8AEwAXAAAhNTMVAxEzERE1MxUlNTMVITUzFSU1IRUBAICAgID+AIABgID+AAGAgIABAAEA/wABAICAgICAgICAgIAABQAAAAACgAOAAAMABwALABEAFQAAMzUhFQM1IxUBETMRNxEhNTMRATUhFYACAICA/oCAgAEAgP4AAYCAgAGAgID/AAKA/YCAAYCA/gACAICAAAAABAAAAAACgAOAAAsADwATABcAADERMxUhNTMRIxEhERE1MxUzNTMVJTUzFYABgICA/oCAgID/AIACgICA/YABgP6AAoCAgICAgICAAAIAAAAAAoADgAADABEAACURMxEFESEVIREhETMRIREhFQIAgP2AAYD/AAEAgP6AAYCAAQD/AIADgID/AAEA/oD/AIAAAwAAAAACgAOAAAMABwALAAAzNSEVJREzERE1IRWAAgD9gIACAICAgAKA/YACgICAAAAAAAQAAAAAAoADgAADAAcACwATAAAlNTMVNREzEQE1MxUBESEVIREhFQGAgID/AID+AAGA/wABAICAgIABgP6AAYCAgP2AA4CA/YCAAAABAAAAAAKAA4AACwAAMREhFSERIRUhESEVAoD+AAGA/oACAAOAgP8AgP8AgAAAAAABAAAAAAKAA4AACQAAMREhFSERIRUhEQKA/gABgP6AA4CA/wCA/oAAAwAAAAACgAOAAAcACwAPAAAzNSERITUhESURMxERNSEVgAGA/wABgP2AgAIAgAEAgP4AgAKA/YACgICAAAAAAAEAAAAAAoADgAALAAAxETMRIREzESMRIRGAAYCAgP6AA4D+gAGA/IABgP6AAAAAAAEAAAAAAoADgAALAAAxNSERITUhFSERIRUBAP8AAoD/AAEAgAKAgID9gIAAAwAAAAACgAOAAAMABwANAAAzNSEVJREzESERITUhEYABgP4AgAGA/wABgICAgAGA/oACgID9AAAHAAAAAAKAA4AAAwAHAAsADwATABsAHwAAITUzFSU1MxUlNTMVAzUzFTU1MxUBETMRMxUjEQE1MxUCAID/AID/AICAgID+AICAgAGAgICAgICAgICAAQCAgICAgP2AA4D+gID+gAMAgIAAAAABAAAAAAKAA4AABQAAMREzESEVgAIAA4D9AIAAAwAAAAACgAOAAAMACwATAAABETMRAREzFTMRIxEhESMRMzUzEQEAgP6AgICAAYCAgIABAAEA/wD/AAOAgP8A/gACAAEAgPyAAAAAAAMAAAAAAoADgAADAAsAEwAAATUzFQERMxEzFSMRIREjNTMRMxEBAID+gICAgAGAgICAAYCAgP6AA4D/AID+AAEAgAIA/IAAAAQAAAAAAoADgAADAAcACwAPAAAzNSEVJREzESERMxEBNSEVgAGA/gCAAYCA/gABgICAgAKA/YACgP2AAoCAgAACAAAAAAKAA4AAAwANAAABETMRAREhFSERIRUhEQIAgP2AAgD+gAGA/oACAAEA/wD+AAOAgP8AgP6AAAAHAAAAAAKAA4AAAwAHAAsADwATABcAGwAAMzUhFTM1MxUlNTMVJTUzFQURMxElETMRATUhFYABAICA/wCA/wCA/oCAAYCA/gABgICAgICAgICAgICAAoD9gIACAP4AAgCAgAAAAwAAAAACgAOAAAMABwATAAAhETMRAxEzEQERIRUhESERIzUhEQIAgICA/YACAP6AAYCA/wABAP8AAgABAP8A/gADgID/AP8AgP6AAAUAAAAAAoADgAADAAcACwAPABMAADE1IRU1ETMRATUhFSURMxERNSEVAgCA/gABgP4AgAIAgICAAQD/AAEAgICAAQD/AAEAgIAAAAABAAAAAAKAA4AABwAAIREhNSEVIREBAP8AAoD/AAMAgID9AAADAAAAAAKAA4AAAwAHAAsAADM1IRUlETMRIREzEYABgP4AgAGAgICAgAMA/QADAP0AAAAABQAAAAACgAOAAAMABwALAA8AEwAAITUzFSU1MxUzNTMVJREzESERMxEBAID/AICAgP4AgAGAgICAgICAgICAAoD9gAKA/YAABQAAAAACgAOAAAMABwALAA8AEwAAMxEzETMRMxEBETMRIREzESERMxGAgICA/wCA/oCAAYCAAQD/AAEA/wABAAGA/oACgP2AAoD9gAAAAAAJAAAAAAKAA4AAAwAHAAsADwATABcAGwAfACMAADERMxEhETMRATUzFTM1MxUlNTMVJTUzFTM1MxUlETMRIREzEYABgID+AICAgP8AgP8AgICA/gCAAYCAAQD/AAEA/wABAICAgICAgICAgICAgIABAP8AAQD/AAAFAAAAAAKAA4AAAwAHAAsADwATAAAhETMRAREzETMRMxEBETMRIREzEQEAgP8AgICA/gCAAYCAAYD+gAGAAQD/AAEA/wABAAEA/wABAP8AAAUAAAAAAoADgAAFAAkADQARABcAADERMxUhFQE1MxU1NTMVNTUzFTU1ITUhEYACAP4AgICA/gACgAEAgIABAICAgICAgICAgICA/wAAAAAAAQCAAAACAAOAAAcAADMRIRUhESEVgAGA/wABAAOAgP2AgAAABQAAAIACgAMAAAMABwALAA8AEwAAJTUzFSU1MxUlNTMVJTUzFSU1MxUCAID/AID/AID/AID/AICAgICAgICAgICAgICAgIAAAQCAAAACAAOAAAcAADM1IREhNSERgAEA/wABgIACgID8gAAABQAAAgACgAOAAAMABwALAA8AEwAAETUzFSE1MxUlNTMVMzUzFSU1MxWAAYCA/gCAgID/AIACAICAgICAgICAgICAgAABAAAAAAKAAIAAAwAAMTUhFQKAgIAAAAACAIACgAIAA4AAAwAHAAABNTMVJTUhFQGAgP6AAQACgICAgICAAAAAAwAAAAACgAKAAAMADQARAAA1NTMVFTUhNSE1ITUzEQE1IRWAAYD+gAGAgP4AAYCAgICAgICAgP4AAgCAgAAAAAIAAAAAAoADgAADAA0AACURMxEFETMRIRUhESEVAgCA/YCAAYD+gAGAgAGA/oCAA4D/AID+gIAAAwAAAAACgAKAAAMABwALAAAzNSEVJREzERE1IRWAAgD9gIACAICAgAGA/oABgICAAAAAAAIAAAAAAoADgAADAA0AADURMxEVNSERITUhETMRgAGA/oABgICAAYD+gICAAYCAAQD8gAADAAAAAAKAAoAAAwANABEAADM1IRUlETMVITUzESEVETUhFYACAP2AgAGAgP4AAYCAgIABgICA/wCAAYCAgAAAAgAAAAACgAOAAAsADwAAMxEjNTM1MxUhFSERETUhFYCAgIABgP6AAYACAICAgID+AAMAgIAAAAAEAAAAAAKAAoAAAwAHAA8AEwAAMTUhFQE1MxUBNSE1ITUzEQE1IRUCAP4AgAGA/oABgID+AAGAgIABgICA/wCAgID+gAGAgIAAAAAAAgAAAAACgAOAAAMACwAAIREzESERMxEhFSERAgCA/YCAAYD+gAIA/gADgP8AgP4AAAAAAAIAAAAAAoADgAAJAA0AADE1IREhNSERIRUBNTMVAQD/AAGAAQD+gICAAYCA/gCAAwCAgAAEAAAAAAKAA4AAAwAHAA0AEQAAMzUhFSURMxEhESM1IREDNTMVgAGA/gCAAYCAAQCAgICAgAEA/wABgID+AAKAgIAAAAUAAAAAAoADgAADAAcACwAPABcAACE1MxUlNTMVAzUzFTU1MxUBETMRIRUhEQIAgP8AgICAgP2AgAEA/wCAgICAgAEAgICAgID+AAOA/gCA/wAAAAEAgAAAAgADgAAHAAAhESM1IREzFQEAgAEAgAMAgP0AgAAAAAIAAAAAAoACgAADAA0AACERMxEhESEVIxEjESMRAgCA/YACAICAgAIA/gACgID+AAIA/gAAAAAAAgAAAAACgAKAAAMACQAAIREzESERIRUhEQIAgP2AAgD+gAIA/gACgID+AAAEAAAAAAKAAoAAAwAHAAsADwAAMzUhFSURMxEhETMRATUhFYABgP4AgAGAgP4AAYCAgIABgP6AAYD+gAGAgIAAAgAAAAACgAKAAAMADQAAAREzEQERIRUhESEVIRUCAID9gAIA/oABgP6AAQABAP8A/wACgID/AICAAAAAAgAAAAACgAKAAAMADQAAEREzEQE1ITUhESE1IRGAAYD+gAGA/oACAAEAAQD/AP8AgIABAID9gAABAAAAAAKAAoAABQAAMREhFSERAoD+AAKAgP4AAAAAAAUAAAAAAoACgAADAAcACwAPABMAADE1IRU1NTMVJTUhFSU1MxU1NSEVAgCA/gABgP4AgAIAgICAgICAgICAgICAgIAAAgAAAAACgAOAAAMADwAAITUhFSURIzUzETMRIRUhEQEAAYD+AICAgAGA/oCAgIABgIABAP8AgP6AAAAAAgAAAAACgAKAAAMACQAANREzERU1IREzEYABgICAAgD+AICAAgD9gAAAAAAFAAAAAAKAAoAAAwAHAAsADwATAAAhNTMVJREzETMRMxEBETMRIREzEQEAgP8AgICA/gCAAYCAgICAAQD/AAEA/wABAAEA/wABAP8AAAAAAAUAAAAAAoACgAADAAcACwAPABMAADMRMxEzETMRAREzESERMxEhETMRgICAgP8AgP6AgAGAgAEA/wABAP8AAQABAP8AAYD+gAGA/oAAAAAACQAAAAACgAKAAAMABwALAA8AEwAXABsAHwAjAAAxNTMVITUzFSU1MxUzNTMVJTUzFSU1MxUzNTMVJTUzFSE1MxWAAYCA/gCAgID/AID/AICAgP4AgAGAgICAgICAgICAgICAgICAgICAgICAgIAAAAMAAAAAAoACgAADAAcADwAAMTUhFQERMxEBNSE1IREzEQIA/gCAAYD+gAGAgICAAYABAP8A/wCAgAEA/gAAAAADAAAAAAKAAoAABwALABMAADE1MzUzFSEVATUzFTU1ITUhFSMVgIABgP6AgP6AAoCAgICAgAEAgICAgICAgAAAAwCAAAACAAOAAAUACQAPAAAhETMRMxUBNTMVNREhFSMRAQCAgP6AgAEAgAGA/wCAAYCAgIABgID/AAAAAQEAAAABgAOAAAMAACERMxEBAIADgPyAAAAAAAMAgAAAAgADgAAFAAkADwAAMzUzETMRETUzFSURIzUhEYCAgID/AIABAIABAP6AAYCAgIABAID+gAAAAAUAAAGAAoADAAADAAcACwAPABMAAAE1MxUhETMRNzUzFSU1MxUFETMRAYCA/gCAgID/AIABAIABgICAAQD/AICAgICAgIABAP8AAAACAQAAAAGAA4AAAwAHAAAhETMRAzUzFQEAgICAAoD9gAMAgIAAAAAAAwAAAAACgAOAAAcACwATAAAhNSM1IRUhFQERMxERNTM1MxUhFQEAgAIA/wD+gICAgAEAgICAgAEAAYD+gAGAgICAgAACAAAAAAKAA4AADwATAAAxNTMRIzUzETMRMxUjESEVATUhFYCAgICAgAGA/oABAIABAIABAP8AgP8AgAMAgIAACAAAAIACgAMAAAMABwALAA8AEwAXABsAHwAANTUzFSE1MxUlNSEVJTUzFSE1MxUlNSEVJTUzFSE1MxWAAYCA/gABgP4AgAGAgP4AAYD+AIABgICAgICAgICAgICAgICAgICAgICAgIAAAAAABQAAAAACgAOAABMAFwAbAB8AIwAAITUjNTM1IzUzNTMVMxUjFTMVIxUBNTMVMzUzFSU1MxUhNTMVAQCAgICAgICAgID/AICAgP4AgAGAgICAgICAgICAgIACgICAgICAgICAgAAAAAACAQAAAAGAA4AAAwAHAAAhETMRAxEzEQEAgICAAYD+gAIAAYD+gAAABAAAAAACgAOAAAMACwATABcAADE1IRU1NSE1ITUzEQERMxUhFSEVETUhFQIA/oABgID9gIABgP6AAgCAgICAgID+gAEAAYCAgIABgICAAAACAIADAAIAA4AAAwAHAAATNTMVMzUzFYCAgIADAICAgIAAAAAIAAAAAAKAA4AAAwAHAAsADwATABcAGwAfAAAxNSEVMzUhFSU1MxUlNSEVMzUhFQE1IxUhNSMVBREhEQEAgAEA/oCA/oABAIABAP6AgAGAgP6AAoCAgICAgICAgICAgIABgICAgICAAYD+gAACAIABAAIAA4AAAwALAAABNSMVBxEhNSE1IREBgICAAQD/AAGAAYCAgIABgICA/YAAAAAABgAAAIACAAKAAAMABwALAA8AEwAXAAA3NTMVMzUzFSURMxEzETMRATUzFTM1MxWAgICA/gCAgID/AICAgICAgICAgAEA/wABAP8AAQCAgICAAAAAAQAAAQACgAIAAAUAAAE1ITUhEQIA/gACgAEAgID/AAACAAAAAAKAA4AAAwAHAAAlESERBxEhEQIA/oCAAoCAAoD9gIADgPyAAAAAAAEAgAMAAgADgAADAAATNSEVgAGAAwCAgAAAAAAEAIACAAIAA4AAAwAHAAsADwAAATUzFSU1MxUzNTMVJTUzFQEAgP8AgICA/wCAAgCAgICAgICAgICAAAACAAAAgAKAAwAAAwAPAAA1NSEVATUhNSE1MxUhFSEVAoD+gP8AAQCAAQD/AICAgAEAgICAgICAAAEAgAEAAgADgAALAAATESE1ITUhESEVIRWAAQD/AAGA/wABAAEAAYCAgP6AgIAAAAEAgAEAAgADgAALAAATNSE1ITUhNSE1IRGAAQD/AAEA/wABgAEAgICAgID9gAAAAAIBAAKAAoADgAADAAcAAAE1MxU1NSEVAQCAAQACgICAgICAAAIAAAAAAoACgAAHAAsAADERMxEhFSEVAREzEYABgP6AAYCAAoD+gICAAQABgP6AAAEAAAAAAoADgAANAAAhESM1IxEzNSERIxEjEQEAgICAAgCAgAGAgAEAgPyAAwD9AAAAAAABAQABgAGAAgAAAwAAATUzFQEAgAGAgIAAAAAAAwCAAAACAAGAAAMABwALAAAzNSEVNTUzFSU1MxWAAQCA/wCAgICAgICAgIAAAAAAAQCAAQABgAOAAAUAAAERIzUhEQEAgAEAAQACAID9gAACAIABAAIAA4AAAwAHAAABESMRBxEhEQGAgIABgAGAAYD+gIACgP2AAAAAAAYAAACAAgACgAADAAcACwAPABMAFwAANTUzFTM1MxUlETMRMxEzEQE1MxUzNTMVgICA/wCAgID+AICAgICAgICAgAEA/wABAP8AAQCAgICAAAAAAAEBgACAAoABgAADAAAlESERAYABAIABAP8AAAACAYAAgAKAAwAAAwAHAAAlESERAREhEQGAAQD/AAEAgAEA/wABgAEA/wAAAAMAAACAAoADAAADAAcACwAANREhETMRIREBESERAQCAAQD/AAEAgAEA/wABAP8AAYABAP8AAAAABgAAAAACgAOAAAMABwALAA8AEwAXAAAzNSEVJTUzFSE1MxUlNTMVNREzEQM1MxWAAYD+AIABgID+AICAgICAgICAgICAgICAgAEA/wABgICAAAAABgAAAAACgAUAAAsADwATABcAGwAfAAAxETMVITUzESMRIRERNTMVMzUzFSU1MxUDNTMVJTUhFYABgICA/oCAgID/AICAgP6AAQACgICA/YABgP6AAoCAgICAgICAAQCAgICAgAAAAAAGAAAAAAKABQAACwAPABMAFwAbAB8AADERMxUhNTMRIxEhERE1MxUzNTMVJTUzFQM1MxU1NSEVgAGAgID+gICAgP8AgICAAQACgICA/YABgP6AAoCAgICAgICAAQCAgICAgAAACQAAAAACgAUAAAsADwATABcAGwAfACMAJwArAAAxETMVITUzESMRIRERNTMVMzUzFSU1MxUlNTMVITUzFSU1MxUzNTMVJTUzFYABgICA/oCAgID/AID+gIABgID+AICAgP8AgAKAgID9gAGA/oACgICAgICAgICAgICAgICAgICAgICAAAAAAAkAAAAAAoAFAAALAA8AEwAXABsAHwAjACcAKwAAMREzFSE1MxEjESERETUzFTM1MxUlNTMVNTUzFSU1MxUzNTMVMzUzFSU1MxWAAYCAgP6AgICA/wCAgP4AgICAgID+AIACgICA/YABgP6AAoCAgICAgICAgICAgICAgICAgICAgAAAAAYAAAAAAoAEgAALAA8AEwAXABsAHwAAMREzFSE1MxEjESERETUzFTM1MxUlNTMVATUzFTM1MxWAAYCAgP6AgICA/wCA/wCAgIACgICA/YABgP6AAoCAgICAgICAAQCAgICAAAAHAAAAAAKABQAACwAPABMAFwAbAB8AIwAAMREzFSE1MxEjESERETUzFTM1MxUlETMRATUzFTM1MxUlNTMVgAGAgID+gICAgP8AgP8AgICA/wCAAoCAgP2AAYD+gAKAgICAgIABAP8AAQCAgICAgICAAAAAAAEAAAAAAoADgAAXAAAxETMVMzUjNTM1IRUhESEVIREhFSERIxGAgICAAYD/AAEA/wABAP6AgAKAgICAgID/AID/AIABgP6AAAUAAP6AAoADgAADAAcADwATABcAABM1IRU1NTMVJTUjNSEVIRUBETMRETUhFYABAID/AIACAP8A/oCAAgD+gICAgICAgICAgIABAAKA/YACgICAAAMAAAAAAoAFAAALAA8AEwAAMREhFSERIRUhESEVATUzFSU1IRUCgP4AAYD+gAIA/oCA/oABAAOAgP8AgP8AgAQAgICAgIAAAAMAAAAAAoAFAAALAA8AEwAAMREhFSERIRUhESEVATUzFTU1IRUCgP4AAYD+gAIA/oCAAQADgID/AID/AIAEAICAgICAAAAAAAQAAAAAAoAFAAAPABMAFwAbAAAxETMVITUzESERIRUhESEVATUzFTM1MxUlNTMVgAGAgP4AAYD+gAIA/gCAgID/AIAEAICA/wD/AID/AIAEAICAgICAgIAAAAAAAwAAAAACgASAAAsADwATAAAxESEVIREhFSERIRUBNTMVMzUzFQKA/gABgP6AAgD+AICAgAOAgP8AgP8AgAQAgICAgAADAAAAAAKABQAACwAPABMAADE1IREhNSEVIREhFQE1MxUlNSEVAQD/AAKA/wABAP6AgP6AAQCAAoCAgP2AgAQAgICAgIAAAAADAAAAAAKABQAACwAPABMAADE1IREhNSEVIREhFQE1MxU1NSEVAQD/AAKA/wABAP6AgAEAgAKAgID9gIAEAICAgICAAAQAAAAAAoAFAAAPABMAFwAbAAAxNSERIREzFSE1MxEhESEVATUzFTM1MxUlNTMVAQD/AIABgID/AAEA/gCAgID/AICAAoABAICA/wD9gIAEAICAgICAgIAAAAAAAwAAAAACgASAAAsADwATAAAxNSERITUhFSERIRUBNTMVMzUzFQEA/wACgP8AAQD+AICAgIACgICA/YCABACAgICAAAACAAAAAAKAA4AAAwATAAAlETMRBREjNTMRIRUhETMVIxEhFQIAgP4AgIABgP8AgIABAIACgP2AgAGAgAGAgP8AgP8AgAAAAAAIAAAAAAKABQAAAwALABMAFwAbAB8AIwAnAAABNTMVAREzETMVIxEhESM1MxEzEQE1MxUlNTMVMzUzFTM1MxUlNTMVAQCA/oCAgIABgICAgP8AgP4AgICAgID+AIABgICA/oADgP8AgP4AAQCAAgD8gAOAgICAgICAgICAgICAAAYAAAAAAoAFAAADAAcACwAPABMAFwAAMzUhFSURMxEhETMRATUhFQE1MxUlNSEVgAGA/gCAAYCA/gABgP8AgP6AAQCAgIACgP2AAoD9gAKAgIABAICAgICAAAAABgAAAAACgAUAAAMABwALAA8AEwAXAAAzNSEVJREzESERMxEBNSEVATUzFTU1IRWAAYD+AIABgID+AAGA/wCAAQCAgIACgP2AAoD9gAKAgIABAICAgICAAAkAAAAAAoAFAAADAAcACwAPABMAFwAbAB8AIwAAMzUhFSURMxEhETMRATUhFSU1MxUhNTMVJTUzFTM1MxUlNTMVgAGA/gCAAYCA/gABgP4AgAGAgP4AgICA/wCAgICAAoD9gAKA/YACgICAgICAgICAgICAgICAgAAAAAAIAAAAAAKABQAAAwAHAAsAEQAVABkAHQAhAAAzNSEVJREzESERMxEBNSE1MxEBNTMVMzUzFTM1MxUlNTMVgAGA/gCAAYCA/gABAID+AICAgICA/gCAgICAAoD9gAKA/YACgICA/wABAICAgICAgICAgAAAAAYAAAAAAoAEgAADAAcACwAPABMAFwAAMzUhFSURMxEhETMRATUhFQE1MxUzNTMVgAGA/gCAAYCA/gABgP6AgICAgICAAoD9gAKA/YACgICAAQCAgICAAAAJAAAAgAKAAwAAAwAHAAsADwATABcAGwAfACMAADU1MxUhNTMVJTUzFTM1MxUlNTMVJTUzFTM1MxUlNTMVITUzFYABgID+AICAgP8AgP8AgICA/gCAAYCAgICAgICAgICAgICAgICAgICAgICAgIAABQAAAAACgAOAAAMABwAPABcAGwAAMzUhFQE1MxUBETMRMxUjFSERIzUzNTMRATUhFYABgP8AgP6AgICAAYCAgID+AAGAgIABgICA/wACgP6AgIABgICA/YACgICAAAAABQAAAAACgAUAAAMABwALAA8AEwAAMzUhFSURMxEhETMRATUzFSU1IRWAAYD+AIABgID+gID+gAEAgICAAwD9AAMA/QADgICAgICAAAUAAAAAAoAFAAADAAcACwAPABMAADM1IRUlETMRIREzEQE1MxU1NSEVgAGA/gCAAYCA/oCAAQCAgIADAP0AAwD9AAOAgICAgIAAAAAGAAAAAAKABQAAAwAHAAsADwATABcAADM1IRUlETMRIREzEQE1MxUzNTMVJTUzFYABgP4AgAGAgP4AgICA/wCAgICAA4D8gAOA/IADgICAgICAgIAAAAAABQAAAAACgASAAAMABwALAA8AEwAAMzUhFSURMxEhETMRATUzFTM1MxWAAYD+AIABgID+AICAgICAgAMA/QADAP0AA4CAgICAAAAAAAcAAAAAAoAFAAADAAcACwAPABMAFwAbAAAhETMRAREzETMRMxEBETMRIREzEQE1MxU1NSEVAQCA/wCAgID+AIABgID+gIABAAGA/oABgAEA/wABAP8AAQABAP8AAQD/AAGAgICAgIAAAgAAAAACgAOAAAMADwAAAREzEQERMxUhFSERIRUhFQIAgP2AgAGA/oABgP6AAQABgP6A/wADgICA/oCAgAAAAAcAAAAAAoADgAADAAcACwAPABMAFwAbAAAhNSEVNREzEQE1MxUlNTMVAREzEQE1MxUlNSEVAQABAID/AID/AID+gIABAID+gAEAgICAAQD/AAEAgICAgID+AAMA/QACgICAgICAAAAABQAAAAACgAQAAAMADQARABUAGQAANTUzFRU1ITUhNSE1MxEBNSEVATUzFSU1IRWAAYD+gAGAgP4AAYD/AID+gAEAgICAgICAgID+AAIAgIABAICAgICAAAUAAAAAAoAEAAADAA0AEQAVABkAADU1MxUVNSE1ITUhNTMRATUhFQE1MxU1NSEVgAGA/oABgID+AAGA/wCAAQCAgICAgICAgP4AAgCAgAEAgICAgIAAAAAIAAAAAAKABAAAAwANABEAFQAZAB0AIQAlAAA1NTMVFTUhNSE1ITUzEQE1IRUlNTMVITUzFSU1MxUzNTMVJTUzFYABgP6AAYCA/gABgP4AgAGAgP4AgICA/wCAgICAgICAgID+AAIAgICAgICAgICAgICAgICAAAAHAAAAAAKABAAAAwANABMAFwAbAB8AIwAANTUzFRU1ITUhNSE1MxEBNSE1MxEBNTMVMzUzFTM1MxUlNTMVgAGA/oABgID+AAEAgP4AgICAgID+AICAgICAgICAgP4AAgCAgP8AAQCAgICAgICAgIAABQAAAAACgAOAAAMADQARABUAGQAANTUzFRU1ITUhNSE1MxEBNSEVATUzFTM1MxWAAYD+gAGAgP4AAYD+gICAgICAgICAgICA/gACAICAAQCAgICAAAAAAAYAAAAAAoAEAAADAA0AFQAZAB0AIQAANTUzFRU1ITUhNSE1MxEBNTM1MxUzFQE1MxUzNTMVJTUzFYABgP6AAYCA/gCAgID+gICAgP8AgICAgICAgICA/gACAICAgIABAICAgICAgIAABAAAAAACgAKAAAMAFQAZAB0AADU1MxUVNTM1IzUzNTMVMzUzESEVIRUBNTMVMzUzFYCAgICAgID/AAEA/gCAgICAgICAgICAgICA/wCAgAIAgICAgAAAAAUAAP6AAoACgAADAAcADwATABcAABM1IRU1NTMVJTUjNSEVIRUBETMRETUhFYABAID/AIACAP8A/oCAAgD+gICAgICAgICAgIABAAGA/oABgICAAAUAAAAAAoAEAAADAA0AEQAVABkAADM1IRUlETMVITUzESEVETUhFQE1MxUlNSEVgAIA/YCAAYCA/gABgP8AgP6AAQCAgIABgICA/wCAAYCAgAEAgICAgIAAAAAABQAAAAACgAQAAAMADQARABUAGQAAMzUhFSURMxUhNTMRIRURNSEVATUzFTU1IRWAAgD9gIABgID+AAGA/wCAAQCAgIABgICA/wCAAYCAgAEAgICAgIAAAAgAAAAAAoAEAAADAA0AEQAVABkAHQAhACUAADM1IRUlETMVITUzESEVETUhFSU1MxUhNTMVJTUzFTM1MxUlNTMVgAIA/YCAAYCA/gABgP4AgAGAgP4AgICA/wCAgICAAYCAgP8AgAGAgICAgICAgICAgICAgICAAAUAAAAAAoADgAADAA0AEQAVABkAADM1IRUlETMVITUzESEVETUhFQE1MxUzNTMVgAIA/YCAAYCA/gABgP6AgICAgICAAYCAgP8AgAGAgIABAICAgIAAAAADAAAAAAKABAAACQANABEAADE1IREhNSERIRUBNTMVJTUhFQEA/wABgAEA/oCA/oABAIABgID+AIADAICAgICAAAAAAAMAAAAAAoAEAAAJAA0AEQAAMTUhESE1IREhFQE1MxU1NSEVAQD/AAGAAQD+gIABAIABgID+AIADAICAgICAAAAFAAAAAAKABAAACwAPABMAFwAbAAAxNSERIREzFSERIRUDNTMVJTUzFTM1MxUlNTMVAQD/AIABAAEAgID+AICAgP8AgIABgAEAgP4AgAKAgICAgICAgICAgAAAAAMAAAAAAoADgAAJAA0AEQAAMTUhESE1IREhFQE1MxUzNTMVAQD/AAGAAQD+AICAgIABgID+AIADAICAgIAAAAACAAAAAAKAAoAAAwATAAAlETMRBREjNTMRIRUhFTMVIxUhFQIAgP4AgIABgP8AgIABAIABgP6AgAEAgAEAgICAgIAAAAYAAAAAAoAEAAADAAsADwATABcAGwAAIREzESERITUzESERAzUzFTM1MxUzNTMVJTUzFQIAgP2AAYCA/oCAgICAgID+AIACAP4AAoCA/wD+AAMAgICAgICAgICAAAAAAAYAAAAAAoAEAAADAAcACwAPABMAFwAAMzUhFSURMxEhETMRATUhFQE1MxUlNSEVgAGA/gCAAYCA/gABgP8AgP6AAQCAgIABgP6AAYD+gAGAgIABAICAgICAAAAABgAAAAACgAQAAAMABwALAA8AEwAXAAAzNSEVJREzESERMxEBNSEVATUzFTU1IRWAAYD+AIABgID+AAGA/wCAAQCAgIABgP6AAYD+gAGAgIABAICAgICAAAkAAAAAAoAEAAADAAcACwAPABMAFwAbAB8AIwAAMzUhFSURMxEhETMRATUhFSU1MxUhNTMVJTUzFTM1MxUlNTMVgAGA/gCAAYCA/gABgP4AgAGAgP4AgICA/wCAgICAAYD+gAGA/oABgICAgICAgICAgICAgICAgAAAAAAIAAAAAAKABAAAAwAHAAsAEQAVABkAHQAhAAAzNSEVJREzESERMxEBNSE1MxEBNTMVMzUzFTM1MxUlNTMVgAGA/gCAAYCA/gABAID+AICAgICA/gCAgICAAYD+gAGA/oABgICA/wABAICAgICAgICAgAAAAAYAAAAAAoADgAADAAcACwAPABMAFwAAMzUhFSURMxEhETMRATUhFQE1MxUzNTMVgAGA/gCAAYCA/gABgP6AgICAgICAAYD+gAGA/oABgICAAQCAgICAAAADAAAAgAKAAwAAAwAHAAsAACU1MxUBNSEVATUzFQEAgP6AAoD+gICAgIABAICAAQCAgAAAAwAAAAACgAKAAAMADQAXAAABNTMVATUjETMRMxUhFTURIzUhNSEVMxEBAID/AICAgAEAgP8AAYCAAQCAgP8AgAGA/wCAgIABAICAgP6AAAAEAAAAAAKABAAAAwAJAA0AEQAANREzERU1IREzEQE1MxUlNSEVgAGAgP6AgP6AAQCAAgD+AICAAgD9gAMAgICAgIAAAAQAAAAAAoAEAAADAAkADQARAAA1ETMRFTUhETMRATUzFTU1IRWAAYCA/oCAAQCAAgD+AICAAgD9gAMAgICAgIAAAAAABQAAAAACgAQAAAMACQANABEAFQAANREzERU1IREzEQE1MxUzNTMVJTUzFYABgID+AICAgP8AgIACgP2AgIACgP0AAwCAgICAgICAAAQAAAAAAoADgAADAAkADQARAAA1ETMRFTUhETMRATUzFTM1MxWAAYCA/gCAgICAAgD+AICAAgD9gAMAgICAgAAFAAAAAAKABAAAAwAHAA8AEwAXAAAxNSEVAREzEQE1ITUhETMRATUzFTU1IRUCAP4AgAGA/oABgID+gIABAICAAYABAP8A/wCAgAEA/gACgICAgICAAAAAAgAAAAACgAKAAAMADwAAATUzFQERMxUhFSEVIRUhFQIAgP2AgAGA/oABgP6AAQCAgP8AAoCAgICAgAAABQAAAAACgAOAAAMABwAPABMAFwAAMTUhFQERMxEBNSE1IREzEQE1MxUzNTMVAgD+AIABgP6AAYCA/gCAgICAgAGAAQD/AP8AgIABAP4AAoCAgICAAAAAAAMAAAAAAoADgAADAAcACwAAMzUhFSURMxEhETMRgAGA/gCAAYCAgICAAwD9AAMA/QAAAAACAAAAAAKAAoAAAwAJAAA1ETMRFTUhETMRgAGAgIACAP4AgIACAP2AAAAAAAcAAAAAAoAEgAADAAcACwAPABMAFwAbAAAhETMRAREzETMRMxEBETMRIREzEQE1MxUzNTMVAQCA/wCAgID+AIABgID+AICAgAGA/oABgAEA/wABAP8AAQABAP8AAQD/AAGAgICAgAAAAgCAAoACAAOAAAMABwAAEzUzFTU1IRWAgAEAAoCAgICAgAAAAgCAAAACAAEAAAMABwAAMzUzFTU1IRWAgAEAgICAgIAAAAAAAQEAAAACAAEAAAUAACERMxUzFQEAgIABAICAAAMAAAAAAQADgAADAAkADQAAMTUzFTU1IzUhEQERIRGAgAEA/wABAICAgICA/wACAAEA/wAAAAAABAAAAAACgAOAAAsADwATABcAADERMxUhNTMRIxEhERE1MxUzNTMVJTUzFYABgICA/oCAgID/AIACgICA/YABgP6AAoCAgICAgICAAAIAAAAAAoADgAADABEAACURMxEFESEVIREhETMRIREhFQIAgP2AAYD/AAEAgP6AAYCAAQD/AIADgID/AAEA/oD/AIAAAQAAAAACgAOAAAUAADERIRUhEQKA/gADgID9AAAAAAAEAAAAAAKAA4AABwALAA8AEwAAMREzESERMxEBETMRMxEzEQERMxGAAYCA/gCAgID/AIABgP8AAQD+gAGAAQD/AAEA/wABAAEA/wAAAQAAAAACgAOAAAsAADERIRUhESEVIREhFQKA/gABgP6AAgADgID/AID/AIAAAAAABQAAAAACgAOAAAUACQANABEAFwAAMREzFSEVATUzFTU1MxU1NTMVNTUhNSERgAIA/gCAgID+AAKAAQCAgAEAgICAgICAgICAgID/AAAAAAABAAAAAAKAA4AACwAAMREzESERMxEjESERgAGAgID+gAOA/oABgPyAAYD+gAAAAAAFAAAAAAKAA4AAAwAHAAsADwATAAAzNSEVATUzFQERMxEhETMRATUhFYABgP8AgP6AgAGAgP4AAYCAgAGAgID/AAKA/YACgP2AAoCAgAAAAAEAAAAAAoADgAALAAAxNSERITUhFSERIRUBAP8AAoD/AAEAgAKAgID9gIAABwAAAAACgAOAAAMABwALAA8AEwAbAB8AACE1MxUlNTMVJTUzFQM1MxU1NTMVAREzETMVIxEBNTMVAgCA/wCA/wCAgICA/gCAgIABgICAgICAgICAgAEAgICAgID9gAOA/oCA/oADAICAAAAABQAAAAACgAOAAAMABwALAA8AEwAAMREzESERMxEBETMRMxEzEQERMxGAAYCA/gCAgID/AIABgP6AAYD+gAGAAQD/AAEA/wABAAEA/wAAAAADAAAAAAKAA4AAAwALABMAAAERMxEBETMVMxEjESERIxEzNTMRAQCA/oCAgIABgICAgAEAAQD/AP8AA4CA/wD+AAIAAQCA/IAAAAAAAwAAAAACgAOAAAMACwATAAABNTMVAREzETMVIxEhESM1MxEzEQEAgP6AgICAAYCAgIABgICA/oADgP8AgP4AAQCAAgD8gAAAAwAAAAACgAOAAAMABwALAAAxNSEVATUhFQE1IRUCgP4AAYD+AAKAgIABgICAAYCAgAAAAAQAAAAAAoADgAADAAcACwAPAAAzNSEVJREzESERMxEBNSEVgAGA/gCAAYCA/gABgICAgAKA/YACgP2AAoCAgAABAAAAAAKAA4AACwAAMxEjNSEVIxEjESMRgIACgICAgAMAgID9AAMA/QAAAAIAAAAAAoADgAADAA0AAAERMxEBESEVIREhFSERAgCA/YACAP6AAYD+gAIAAQD/AP4AA4CA/wCA/oAAAAUAAAAAAoADgAAFAAkADQARABcAADERMxUhFQE1MxU1NTMVJTUzFSURIRUhFYACAP4AgID/AID/AAKA/gABAICAAQCAgICAgICAgIABAICAAAAAAAEAAAAAAoADgAAHAAAhESE1IRUhEQEA/wACgP8AAwCAgP0AAAUAAAAAAoADgAADAAcACwAPABMAACERMxEBETMRMxEzEQERMxEhETMRAQCA/wCAgID+AIABgIABgP6AAYABAP8AAQD/AAEAAQD/AAEA/wAAAwAAAAACgAOAAAMABwAbAAARNTMVITUzFQERIzUzNSM1MxEzETMVIxUzFSMRgAGAgP6AgICAgICAgICAAYCAgICA/oABAICAgAEA/wCAgID/AAAACQAAAAACgAOAAAMABwALAA8AEwAXABsAHwAjAAAxETMRIREzEQE1MxUzNTMVJTUzFSU1MxUzNTMVJREzESERMxGAAYCA/gCAgID/AID/AICAgP4AgAGAgAEA/wABAP8AAQCAgICAgICAgICAgICAAQD/AAEA/wAAAwAAAAACgAOAAAMADwATAAARETMRExEjNTMRMxEzFSMRExEzEYCAgICAgICAgAIAAYD+gP4AAYCAAYD+gID+gAIAAYD+gAAABQAAAAACgAOAAAUACwAPABMAFwAAMTUzNTMRMxEzFTMVAREzESERMxEBNSEVgICAgID9gIABgID+AAGAgID/AAEAgIABAAIA/gACAP4AAgCAgAAABAAAAAACgAKAAAMABwALABcAADM1IRUlETMRETUhFRM1IzUzNSM1MzUzEYABAP6AgAEAgICAgICAgICAAYD+gAGAgID+AICAgICA/YAAAAAEAAAAAAKAA4AAAwAPABMAFwAAAREzEQERMxUhFSERIRUhFQE1MxUlNSEVAgCA/YCAAYD+gAGA/oABgID+AAGAAQABAP8A/wADAICA/wCAgAKAgICAgIAABQAAAAACgAKAAAMABwALAA8AEwAAIREzEQE1MxUzNTMVJREzESERMxEBAID/AICAgP4AgAGAgAEA/wABAICAgICAAQD/AAEA/wAAAAUAAAAAAoADgAADAAcACwATABkAADM1IRUlETMRIREzEQE1MzUzFTMVAREhFSEVgAGA/gCAAYCA/gCAgID+gAGA/wCAgIABAP8AAQD/AAEAgICAgAEAAQCAgAAAAwAAAAACgAKAAAMACwAPAAAzNSEVJREzFSEVIRURNSEVgAIA/YCAAYD+gAIAgICAAYCAgIABgICAAAAABQAAAAACgAOAAAMABwANABEAGQAAITUhFTU1MxUlETMVIRUBNTMVNTUhNSEVIRUBAAEAgP2AgAGA/oCA/wACgP8AgICAgICAAQCAgAEAgICAgICAgAAAAAIAAAAAAoACgAADAAkAACERMxEhESEVIRECAID9gAIA/oACAP4AAoCA/gAAAwAAAAACgAOAAAMADwATAAAzNSEVJREzESERMxEjESERETUhFYABgP4AgAGAgID+gAGAgICAAoD/AAEA/YABAP8AAoCAgAAAAQEAAAABgAKAAAMAACERMxEBAIACgP2AAAAAAAUAAAAAAoACgAADAAcACwATABcAACE1MxUlNTMVAzUzFQERMxEhFSERATUzFQIAgP8AgICA/gCAAQD/AAGAgICAgICAAQCAgP6AAoD/AID/AAIAgIAAAAAHAAAAAAKAA4AAAwAHAAsADwATABcAGwAAMREzESERMxEBNTMVMzUzFSU1MxUlNTMVJTUzFYABgID+AICAgP8AgP8AgP8AgAGA/oABgP6AAYCAgICAgICAgICAgICAAAACAAAAAAKAAoAABwALAAAxETMRIRUhFQERMxGAAYD+gAGAgAKA/oCAgAEAAYD+gAAFAAAAAAKAAoAAAwAHAAsADwATAAAhNTMVJTUzFTM1MxUlETMRIREzEQEAgP8AgICA/gCAAYCAgICAgICAgIABgP6AAYD+gAAEAAAAAAKAA4AAAwAHAA0AFwAAITUhFTU1MxUlETMVIRUBESM1IRUhFSEVAQABAID9gIABgP6AgAKA/oABAICAgICAgAEAgIABAAEAgICAgAAAAAAEAAAAAAKAAoAAAwAHAAsADwAAMzUhFSURMxEhETMRATUhFYABgP4AgAGAgP4AAYCAgIABgP6AAYD+gAGAgIAAAQAAAAACgAKAAA0AADMRIzUhFSMRMxUhESMRgIACgICA/wCAAgCAgP6AgAIA/gAAAwAAAAACgAKAAAcACwAPAAAxETMRIRUhFQERMxEBNSEVgAGA/oABgID+AAGAAgD/AICAAQABAP8AAQCAgAAAAAQAAAAAAoACgAADAAkADQARAAAhNSEVNTUhNSERATUzFTU1IRUBAAEA/oACAP2AgAIAgICAgID/AAEAgICAgIAAAAAAAwAAAAACgAKAAAMABwANAAAzNSEVJREzESERITUhEYABgP4AgAGA/oACAICAgAGA/oABgID+AAABAAAAAAKAAoAABwAAIREhNSEVIREBAP8AAoD/AAIAgID+AAADAAAAAAKAAoAAAwAHAAsAADM1IRUlETMRIREzEYABgP4AgAGAgICAgAIA/gACAP4AAAAAAwAAAAACgAKAAAMABwAbAAARNTMVITUzFQE1IzUzNSM1MzUzFTMVIxUzFSMVgAGAgP6AgICAgICAgICAAQCAgICA/wCAgICAgICAgICAAAAJAAAAAAKAAoAAAwAHAAsADwATABcAGwAfACMAADE1MxUhNTMVJTUzFTM1MxUlNTMVJTUzFTM1MxUlNTMVITUzFYABgID+AICAgP8AgP8AgICA/gCAAYCAgICAgICAgICAgICAgICAgICAgICAgAAAAwAAAAACgAKAAAMADwATAAARETMRExEjNTMRMxEzFSMRExEzEYCAgICAgICAgAGAAQD/AP6AAQCAAQD/AID/AAGAAQD/AAAABQAAAAACgAKAAAMABwALAA8AEwAAMzUzFTM1MxUlETMRMxEzETMRMxGAgICA/gCAgICAgICAgICAAgD+AAIA/gACAP4AAAAAAQAAAYACgAIAAAMAABE1IRUCgAGAgIAAAgAAAgABAAOAAAUACQAAEREzFTMVAzUzFYCAgIACAAEAgIABAICAAAIAAAIAAQADgAADAAkAABE1MxU1NSM1IRGAgAEAAgCAgICAgP8AAAACAAAAAAEAAYAAAwAJAAAxNTMVNTUjNSERgIABAICAgICA/wAAAAAAAgAAAgABAAOAAAMACQAAEzUzFSURIRUjFYCA/wABAIACAICAgAEAgIAAAAADAAACAAIAA4AACQANABEAABERMxUzNTMVMxUBNTMVMzUzFYCAgID+gICAgAIAAQCAgICAAQCAgICAAAADAAACAAIAA4AAAwAHABEAABE1MxUzNTMVJTUjNSERIzUjFYCAgP8AgAIAgIACAICAgICAgID/AICAAAADAAAAAAIAAYAAAwAHABEAADE1MxUzNTMVJTUjNSERIzUjFYCAgP8AgAIAgICAgICAgICA/wCAgAAAAAABAIABAAIAA4AACwAAAREjNTMRMxEzFSMRAQCAgICAgAEAAQCAAQD/AID/AAAAAAACAIABAAIAAoAAAwAHAAABNSMVBxEhEQGAgIABgAGAgICAAYD+gAAAAwAAAAACgAEAAAMABwALAAAxETMRMxEzETMRMxGAgICAgAEA/wABAP8AAQD/AAAAAwEA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"
font = ImageFont.truetype(BytesIO(b64decode(FONT_BASE64)), 16)


# display config
ROWS = [(2,21), (23, 42), (44, 63), (65, 84), (86, 105), (107, 126)]
COLS = (
	[(2,11), (12,21), (22,31), (32,41), (42,51), (52,61)] if INA_INIT # ina enabled: 6 lines
	else [(6,15), (20,29), (34,43), (48,57), (65,65), (65,65)] # ina disabled: 4 lines
)

CHARS_PER_LINE = 21
DISP_REFRESH_SECS = 2


# display init
disp = SSD1306_128_64(rst=None) # 128x64
disp.begin()
disp.clear()
disp.display()
if len(argv) > 1 and argv[1] == "-c": exit(0) # exit after clear display if 'c' option

width = disp.width
height = disp.height
image = Image.new('1', (width, height))

draw = ImageDraw.Draw(image)

def exit_signal_handler(s, f): # clear display before terminated by a signal
	disp.clear()
	disp.display()
	exit(0)
signal(SIGINT, exit_signal_handler)
signal(SIGQUIT, exit_signal_handler)
signal(SIGTERM, exit_signal_handler)
signal(SIGHUP, exit_signal_handler)


# CPU bar info (for splitting into each core)
CPU_COUNT = psutil.cpu_count()
CPU_BAR_WIDTH = (ROWS[4][1] - ROWS[1][0] - 5) / CPU_COUNT
CPU_ROWS = []
for i in range(CPU_COUNT):
	CPU_ROWS.append((ROWS[1][0] + (i * CPU_BAR_WIDTH), ROWS[1][0] + ((i+1) * CPU_BAR_WIDTH)))


# interface list
if_list = ["eth0", "wlan0"]





### helper functions ###

# print a percent bar
def percent_bar (draw, color, dim, percent):
	draw.rectangle((dim[0]+1, dim[1]+2, dim[2]-1, dim[3]), outline=color["fg"], fill=color["bg"])
	draw.rectangle((dim[0]+2, dim[1]+3, (dim[2]-dim[0]-4) * min(percent,100) / 100 + dim[0]+2, dim[3]-1),
		outline=color["bg"], fill=color["fg"])

# get disk IO busy time in percent
def disk_io_percent ():
	busy_time_cur = psutil.disk_io_counters().busy_time
	last_timestamp_cur = time()

	ret_val = round((busy_time_cur - disk_io_percent.busy_time) / (last_timestamp_cur - disk_io_percent.last_timestamp) / 10, 0)

	disk_io_percent.busy_time = busy_time_cur
	disk_io_percent.last_timestamp = last_timestamp_cur
	return ret_val

disk_io_percent.busy_time = psutil.disk_io_counters().busy_time
disk_io_percent.last_timestamp = time()

# get NIC IO transmitted bits in percent - not working properly for wlan0
def if_io_percent ():
	io_cnts_cur = psutil.net_io_counters(pernic=True)
	net_if_stats = psutil.net_if_stats()
	last_timestamp_cur = time()

	ret_val = {}
	for ifname in if_list:
		try:
			transmitted_bits = (
				io_cnts_cur[ifname].bytes_sent + io_cnts_cur[ifname].bytes_recv -
				(if_io_percent.io_cnts[ifname].bytes_sent + if_io_percent.io_cnts[ifname].bytes_recv)
			) * 8
			max_possible_bits = net_if_stats[ifname].speed * 1000000 * (last_timestamp_cur - if_io_percent.last_timestamp)

			ret_val[ifname] = min( transmitted_bits / max_possible_bits * 100, 100 )
		except:
			pass

	if_io_percent.io_cnts = io_cnts_cur
	if_io_percent.last_timestamp = last_timestamp_cur

	return ret_val

if_io_percent.io_cnts = psutil.net_io_counters(pernic=True)
if_io_percent.last_timestamp = time()





##### main routine #####
while True:


	### init current loop ###

	# ina219
	try:
		ina_pi.configure()
		ina_batt.configure()
	except:
		pass

	# set fg/bg color: bright on daytime, dark on nighttime (to prevent OLED burn-in)
	hour_cur = datetime.now().hour
	if hour_cur < 6 or hour_cur >= 18:
		color = {"fg": 255, "bg": 0}
	else:
		color = {"fg": 0, "bg": 255}

	line = 0

	# blank screen
	draw.rectangle((0, 0, width-1, height-1), fill=color["bg"])


	### print ip addresses for all listed NIC ###
	if_usages = if_io_percent()
	for iface in if_list:
		ip_addr = "(null)"
		is_bar_printed = False
		try:
			ip_addr = list( filter(lambda x: x.family == AF_INET, psutil.net_if_addrs()[iface]) )[0].address
			str_width = font.getsize(f"I{iface[:CHARS_PER_LINE - len(ip_addr) - 2 - 3]} {ip_addr}")[0]
			percent_bar(draw, color, (str_width + 5, COLS[line][0], ROWS[5][1], COLS[line][1]+1), if_usages[iface])
			is_bar_printed = True
		except:
			pass

		draw.text(
			(ROWS[0][0], COLS[line][0]),
			f"I{ iface[:max(CHARS_PER_LINE - len(ip_addr) - 2 - (3 if is_bar_printed else 0), 1)] } {ip_addr}",
			font=font, outline=color["bg"], fill=color["fg"]
		)


		line += 1


	### print cpu usage ###

	cpu_usages = psutil.cpu_percent(interval=None, percpu=True)
	draw.text( (ROWS[0][0], COLS[line][0]), "CPU", font=font, outline=color["bg"], fill=color["fg"] )

	# print percent bars for each core
	for i in range(CPU_COUNT):
		percent_bar(draw, color, (CPU_ROWS[i][0], COLS[line][0], CPU_ROWS[i][1], COLS[line][1]+1), cpu_usages[i])

	cpu_temp = 0
	try:
		cpu_temp = psutil.sensors_temperatures()['cpu_thermal'][0].current
	except:
		pass
	draw.text( (ROWS[5][0] - 5, COLS[line][0]), f"{cpu_temp:>3.0f}C", font=font, outline=color["bg"], fill=color["fg"] )


	line += 1


	### print mem / disk usage ###

	# mem
	mem_usage = psutil.virtual_memory().percent
	draw.text( (ROWS[0][0], COLS[line][0]), "Mem", font=font, outline=color["bg"], fill=color["fg"] )
	percent_bar(draw, color, (ROWS[1][0], COLS[line][0], ROWS[1][1]+3, COLS[line][1]+1), mem_usage)

	# disk storage usage + io usage
	disk_usage = psutil.disk_usage("/").percent
	draw.text( (ROWS[2][0], COLS[line][0]), " SD", font=font, outline=color["bg"], fill=color["fg"] )
	percent_bar(draw, color, (ROWS[3][0], COLS[line][0], ROWS[3][1]+3, COLS[line][1]+1), disk_usage)

	disk_io_usage = disk_io_percent()
	draw.text( (ROWS[4][0], COLS[line][0]), " IO", font=font, outline=color["bg"], fill=color["fg"] )
	percent_bar(draw, color, (ROWS[5][0], COLS[line][0], ROWS[5][1], COLS[line][1]+1), disk_io_usage)


	line += 1


	### print pi / ups ###
	if INA_INIT:

		# pi
		try:
			pi_W = ina_pi.power() / 1000
			draw.text( (ROWS[0][0], COLS[line][0]), f"Pi {pi_W:>4.1f}W", font=font, outline=color["bg"], fill=color["fg"] )
		except:
			pass

		# ups
		charge_status = "?"
		try:
			charge_V_c = bus.read_word_data(DEVICE_ADDR, 0x7)
			charge_V_micro = bus.read_word_data(DEVICE_ADDR, 0x9)
			if charge_V_c > 4000 or charge_V_micro > 4000:
				charge_status = "+"
			else:
				charge_status = "-"
		except:
			pass

		try:
			batt_W = ina_batt.power() / 1000
			draw.text( (ROWS[3][0], COLS[line][0]), f"UPS {charge_status}{batt_W:>4.1f}W", font=font,
				outline=color["bg"], fill=color["fg"] )
		except:
			pass


		line += 1


	### print ups battery ###

		try:
			batt_V = ina_batt.voltage()
			draw.text( (ROWS[0][0], COLS[line][0]), f"Bat {batt_V:.1f}V", font=font, outline=color["bg"], fill=color["fg"] )

			batt_temp = bus.read_word_data(DEVICE_ADDR, 0xB)
			batt_level = bus.read_word_data(DEVICE_ADDR, 0x13)
			percent_bar(draw, color, (ROWS[2][0] + 10, COLS[line][0], ROWS[4][1] - 5, COLS[line][1]+1), batt_level)
			draw.text( (ROWS[5][0] - 5, COLS[line][0]), f"{batt_temp:>3d}C", font=font, outline=color["bg"], fill=color["fg"] )
		except:
			pass


		line += 1



	### show printed result to display and sleep ###
	disp.image(image)
	disp.display()
	sleep(DISP_REFRESH_SECS)
